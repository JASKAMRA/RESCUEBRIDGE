<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NGO Marketplace - RescueBridge</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Header */
      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 20px 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .logo-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
      }

      .brand-name {
        font-size: 28px;
        font-weight: 700;
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .user-actions {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      .cart-btn,
      .purchases-btn {
        padding: 12px 20px;
        border-radius: 25px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .cart-btn {
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        color: white;
        position: relative;
      }

      .cart-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(255, 111, 0, 0.4);
      }

      .purchases-btn {
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
      }

      .purchases-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .cart-count {
        background: #ff5722;
        color: white;
        border-radius: 50%;
        padding: 2px 8px;
        font-size: 12px;
        font-weight: bold;
        position: absolute;
        top: -5px;
        right: -5px;
      }

      /* Search Section */
      .search-section {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
      }

      .search-container {
        flex: 1;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 15px 50px 15px 20px;
        border: none;
        border-radius: 15px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        font-size: 16px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      .search-btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        border: none;
        padding: 10px 15px;
        border-radius: 10px;
        color: white;
        cursor: pointer;
        font-size: 16px;
      }

      .filter-dropdown {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: none;
        padding: 15px 20px;
        border-radius: 15px;
        font-size: 16px;
        cursor: pointer;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      /* Main Content */
      .main-content {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 30px;
      }

      .products-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .section-title {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 20px;
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .product-card {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      }

      .product-image {
        width: 100%;
        height: 200px;
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        color: white;
      }

      .product-info {
        padding: 20px;
      }

      .product-name {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
      }

      .product-ngo {
        color: #666;
        font-size: 14px;
        margin-bottom: 10px;
      }

      .product-price {
        font-size: 20px;
        font-weight: 700;
        color: #ff6f00;
        margin-bottom: 15px;
      }

      .product-actions {
        display: flex;
        gap: 10px;
      }

      .add-to-cart,
      .view-details {
        padding: 8px 16px;
        border-radius: 20px;
        border: none;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
        text-decoration: none;
        text-align: center;
        flex: 1;
      }

      .add-to-cart {
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        color: white;
      }

      .add-to-cart:hover {
        transform: translateY(-2px);
      }

      .view-details {
        background: transparent;
        color: #ff6f00;
        border: 2px solid #ff6f00;
      }

      .view-details:hover {
        background: #ff6f00;
        color: white;
      }

      /* Sidebar */
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .sidebar-widget {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .widget-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: #333;
      }

      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
      }

      .cart-item:last-child {
        border-bottom: none;
      }

      .cart-item-info {
        flex: 1;
      }

      .cart-item-name {
        font-size: 14px;
        font-weight: 500;
        color: #333;
      }

      .cart-item-price {
        font-size: 12px;
        color: #ff6f00;
        font-weight: 600;
      }

      .remove-item {
        background: none;
        border: none;
        color: #ff5722;
        cursor: pointer;
        font-size: 16px;
      }

      .cart-total {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 2px solid #eee;
        font-size: 18px;
        font-weight: 600;
        color: #333;
      }

      .checkout-btn {
        width: 100%;
        padding: 12px;
        background: linear-gradient(45deg, #ff6f00, #ff8f00);
        color: white;
        border: none;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 15px;
        transition: all 0.3s ease;
      }

      .checkout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(255, 111, 0, 0.4);
      }

      .featured-ngos {
        list-style: none;
      }

      .ngo-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .ngo-item:hover {
        background: #f8f9fa;
        padding-left: 10px;
        border-radius: 8px;
      }

      .ngo-item:last-child {
        border-bottom: none;
      }

      .ngo-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(45deg, #667eea, #764ba2);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 16px;
      }

      .ngo-info {
        flex: 1;
      }

      .ngo-name {
        font-size: 14px;
        font-weight: 500;
        color: #333;
      }

      .ngo-location {
        font-size: 12px;
        color: #666;
      }

      .load-more {
        text-align: center;
        margin-top: 30px;
      }

      .load-more-btn {
        padding: 15px 40px;
        background: linear-gradient(45deg, #667eea, #764ba2);
        color: white;
        border: none;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .load-more-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .empty-cart {
        text-align: center;
        color: #666;
        font-style: italic;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .main-content {
          grid-template-columns: 1fr;
        }

        .header-top {
          flex-direction: column;
          gap: 15px;
        }

        .search-section {
          flex-direction: column;
        }

        .products-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="header-top">
          <div class="logo">
            <div class="logo-icon">🐾</div>
            <div class="brand-name">RescueBridge</div>
          </div>
          <div class="user-actions">
            <a href="{{ url_for('ngo_my_purchases') }}" class="purchases-btn"
              >📦 My Purchases</a
            >

            <button class="cart-btn" onclick="toggleCart()">
              🛒 Cart
              <span class="cart-count" id="cartCount">0</span>
            </button>
          </div>
        </div>

        <div class="search-section">
          <div class="search-container">
            <input
              type="text"
              class="search-input"
              placeholder="Search for animal care products, food, medicines..."
              id="searchInput"
            />
            <button class="search-btn" onclick="searchProducts()">🔍</button>
          </div>
          <select
            class="filter-dropdown"
            id="categoryFilter"
            onchange="filterProducts()"
          >
            <option value="">All Categories</option>
            <option value="food">Pet Food</option>
            <option value="medicine">Medicine</option>
            <option value="accessories">Accessories</option>
            <option value="toys">Toys</option>
          </select>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Products Section -->
        <div class="products-section">
          <h2 class="section-title">🌟 Recommended Products</h2>
          <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here -->
          </div>
          <div class="load-more">
            <button class="load-more-btn" onclick="loadMoreProducts()">
              Load More Products
            </button>
          </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar">
          <!-- Cart Widget -->
          <div class="sidebar-widget" id="cartWidget">
            <h3 class="widget-title">🛒 Shopping Cart</h3>
            <div id="cartItems" class="empty-cart">Your cart is empty</div>
            <div class="cart-total" id="cartTotal" style="display: none">
              Total: ₹<span id="totalAmount">0</span>
            </div>
            <button
              class="checkout-btn"
              id="checkoutBtn"
              onclick="checkout()"
              style="display: none"
            >
              Proceed to Checkout
            </button>
          </div>

          <!-- Featured NGOs -->
          <div class="sidebar-widget">
            <h3 class="widget-title">🏢 Featured NGOs</h3>
            <ul class="featured-ngos" id="featuredNGOs">
              <!-- NGOs will be loaded here -->
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Sample data
      const products = [
        {
          id: 1,
          name: "Premium Dog Food",
          ngo: "Paws & Hearts NGO",
          price: 1200,
          category: "food",
          image: "🍖",
        },
        {
          id: 2,
          name: "Cat Medicine Kit",
          ngo: "Animal Care Foundation",
          price: 800,
          category: "medicine",
          image: "💊",
        },
        {
          id: 3,
          name: "Dog Collar & Leash",
          ngo: "Street Dogs Welfare",
          price: 450,
          category: "accessories",
          image: "🦮",
        },
        {
          id: 4,
          name: "Bird Seed Mix",
          ngo: "Wings of Hope",
          price: 320,
          category: "food",
          image: "🌱",
        },
        {
          id: 5,
          name: "Pet Grooming Kit",
          ngo: "Happy Tails NGO",
          price: 650,
          category: "accessories",
          image: "✂️",
        },
        {
          id: 6,
          name: "Chew Toys Set",
          ngo: "Playful Paws",
          price: 280,
          category: "toys",
          image: "🎾",
        },
        {
          id: 7,
          name: "Vitamin Supplements",
          ngo: "Healthy Pets Foundation",
          price: 950,
          category: "medicine",
          image: "💊",
        },
        {
          id: 8,
          name: "Cat Litter Box",
          ngo: "Feline Friends NGO",
          price: 750,
          category: "accessories",
          image: "🏠",
        },
      ];

      const ngos = [
        { name: "Paws & Hearts NGO", location: "Delhi", initial: "P" },
        { name: "Animal Care Foundation", location: "Mumbai", initial: "A" },
        { name: "Street Dogs Welfare", location: "Bangalore", initial: "S" },
        { name: "Wings of Hope", location: "Chennai", initial: "W" },
        { name: "Happy Tails NGO", location: "Pune", initial: "H" },
        { name: "Playful Paws", location: "Hyderabad", initial: "P" },
        { name: "Healthy Pets Foundation", location: "Kolkata", initial: "H" },
        { name: "Feline Friends NGO", location: "Ahmedabad", initial: "F" },
      ];

      let cart = [];
      let currentPage = 1;
      const productsPerPage = 6;
      let filteredProducts = [...products];

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        loadProducts();
        loadNGOs();
        updateCartDisplay();
      });

      // Load products
      function loadProducts() {
        const startIndex = (currentPage - 1) * productsPerPage;
        const endIndex = startIndex + productsPerPage;
        const productsToShow = filteredProducts.slice(0, endIndex);

        const productsGrid = document.getElementById("productsGrid");
        productsGrid.innerHTML = "";

        productsToShow.forEach((product) => {
          const productCard = `
                    <div class="product-card" onclick="viewProduct(${product.id})">
                        <div class="product-image">${product.image}</div>
                        <div class="product-info">
                            <div class="product-name">${product.name}</div>
                            <div class="product-ngo">by ${product.ngo}</div>
                            <div class="product-price">₹${product.price}</div>
                            <div class="product-actions">
                                <button class="add-to-cart" onclick="event.stopPropagation(); addToCart(${product.id})">Add to Cart</button>
                                <a href="items.html?id=${product.id}" class="view-details">View Details</a>
                            </div>
                        </div>
                    </div>
                `;
          productsGrid.innerHTML += productCard;
        });
      }

      // Load more products
      function loadMoreProducts() {
        currentPage++;
        loadProducts();
      }

      // Load NGOs
      function loadNGOs() {
        const ngosList = document.getElementById("featuredNGOs");
        ngosList.innerHTML = "";

        ngos.forEach((ngo) => {
          const ngoItem = `
                    <li class="ngo-item" onclick="filterByNGO('${ngo.name}')">
                        <div class="ngo-avatar">${ngo.initial}</div>
                        <div class="ngo-info">
                            <div class="ngo-name">${ngo.name}</div>
                            <div class="ngo-location">${ngo.location}</div>
                        </div>
                    </li>
                `;
          ngosList.innerHTML += ngoItem;
        });
      }

      // Search products
      function searchProducts() {
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase();
        if (searchTerm === "") {
          filteredProducts = [...products];
        } else {
          filteredProducts = products.filter(
            (product) =>
              product.name.toLowerCase().includes(searchTerm) ||
              product.ngo.toLowerCase().includes(searchTerm)
          );
        }
        currentPage = 1;
        loadProducts();
      }

      // Filter products
      function filterProducts() {
        const category = document.getElementById("categoryFilter").value;
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase();

        filteredProducts = products.filter((product) => {
          const matchesCategory =
            category === "" || product.category === category;
          const matchesSearch =
            searchTerm === "" ||
            product.name.toLowerCase().includes(searchTerm) ||
            product.ngo.toLowerCase().includes(searchTerm);
          return matchesCategory && matchesSearch;
        });

        currentPage = 1;
        loadProducts();
      }

      // Filter by NGO
      function filterByNGO(ngoName) {
        document.getElementById("searchInput").value = ngoName;
        searchProducts();
      }

      // Add to cart
      function addToCart(productId) {
        const product = products.find((p) => p.id === productId);
        const existingItem = cart.find((item) => item.id === productId);

        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({ ...product, quantity: 1 });
        }

        updateCartDisplay();

        // Show success message
        showMessage("Product added to cart!", "success");
      }

      // Remove from cart
      function removeFromCart(productId) {
        cart = cart.filter((item) => item.id !== productId);
        updateCartDisplay();
        showMessage("Product removed from cart!", "info");
      }

      // Update cart display
      function updateCartDisplay() {
        const cartCount = document.getElementById("cartCount");
        const cartItems = document.getElementById("cartItems");
        const cartTotal = document.getElementById("cartTotal");
        const totalAmount = document.getElementById("totalAmount");
        const checkoutBtn = document.getElementById("checkoutBtn");

        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const totalPrice = cart.reduce(
          (sum, item) => sum + item.price * item.quantity,
          0
        );

        cartCount.textContent = totalItems;

        if (cart.length === 0) {
          cartItems.innerHTML =
            '<div class="empty-cart">Your cart is empty</div>';
          cartTotal.style.display = "none";
          checkoutBtn.style.display = "none";
        } else {
          cartItems.innerHTML = "";
          cart.forEach((item) => {
            const cartItem = `
                        <div class="cart-item">
                            <div class="cart-item-info">
                                <div class="cart-item-name">${item.name} (${
              item.quantity
            })</div>
                                <div class="cart-item-price">₹${
                                  item.price * item.quantity
                                }</div>
                            </div>
                            <button class="remove-item" onclick="removeFromCart(${
                              item.id
                            })">×</button>
                        </div>
                    `;
            cartItems.innerHTML += cartItem;
          });

          totalAmount.textContent = totalPrice;
          cartTotal.style.display = "block";
          checkoutBtn.style.display = "block";
        }
      }

      // View product details
      function viewProduct(productId) {
        window.location.href = `items.html?id=${productId}`;
      }

      // Checkout
      function checkout() {
        if (cart.length === 0) {
          showMessage("Your cart is empty!", "error");
          return;
        }

        // Save order to localStorage
        const order = {
          id: Date.now(),
          items: [...cart],
          total: cart.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0
          ),
          date: new Date().toLocaleString(),
          status: "Processing",
        };

        // Get existing orders or create empty array
        let orders = JSON.parse(localStorage.getItem("ngo_orders") || "[]");
        orders.push(order);
        localStorage.setItem("ngo_orders", JSON.stringify(orders));

        // Clear cart
        cart = [];
        updateCartDisplay();

        showMessage(
          "Order placed successfully! Redirecting to purchases...",
          "success"
        );

        // Redirect to purchases page
        setTimeout(() => {
          window.location.href = "/ngo/my_purchases";
        }, 2000);
      }

      // Toggle cart visibility
      function toggleCart() {
        const cartWidget = document.getElementById("cartWidget");
        cartWidget.scrollIntoView({ behavior: "smooth" });
      }

      // Show message
      function showMessage(message, type) {
        const messageDiv = document.createElement("div");
        messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 10px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;

        if (type === "success") {
          messageDiv.style.background =
            "linear-gradient(45deg, #4caf50, #66bb6a)";
        } else if (type === "error") {
          messageDiv.style.background =
            "linear-gradient(45deg, #f44336, #ef5350)";
        } else {
          messageDiv.style.background =
            "linear-gradient(45deg, #2196f3, #42a5f5)";
        }

        messageDiv.textContent = message;
        document.body.appendChild(messageDiv);

        setTimeout(() => {
          messageDiv.remove();
        }, 3000);
      }

      // Add CSS animation
      const style = document.createElement("style");
      style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
      document.head.appendChild(style);

      // Search on Enter key
      document
        .getElementById("searchInput")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            searchProducts();
          }
        });
    </script>
  </body>
</html>
